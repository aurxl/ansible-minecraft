---
- name: Sanity check - Eula
  assert:
    that: minecraft.eula is true
    success_msg: "You agreed the to the eula."
    fail_msg: |
      You have to agree the eula (more infos about the eula: https://aka.ms/MinecraftEULA).
      To agree the eula set 'eula: true'.

- block:
  - name: Set instance infos
    set_fact:
      instance_infos: "{{ item }}"
    when: item.version == minecraft.version
    loop: "{{ versions }}"
  when: minecraft.version != "latest"

- name: set instance infos
  set_fact:
    instance_infos: "{{ versions[0] }}"
  when: minecraft.version == "latest"

- name: Sanity check - Available version
  assert:
    that: instance_infos is defined
    fail_msg: "Minecraft version {{ minecraft.version }} not available."

- name: Sanity check - Using following
  debug:
    var: instance_infos
